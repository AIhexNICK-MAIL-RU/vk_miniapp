<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Результаты опроса</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .container { max-width: 800px; margin: 0 auto; padding: 16px; }
        .result-item { padding: 12px 0; border-bottom: 1px solid #eee; }
        .result-item:last-child { border-bottom: none; }
        .muted { color: #777; }
        .actions { margin-top: 24px; display: flex; gap: 12px; }
        button { padding: 10px 16px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Результаты опроса</h1>
            <p class="muted">Ваши выбранные ответы сохранены в браузере.</p>
        </header>

        <main id="resultsContainer"></main>

        <div class="actions">
            <button id="backBtn">Назад к опросу</button>
            <button id="clearBtn">Очистить результаты</button>
        </div>
    </div>

    <script>
        (function() {
            function loadResults() {
                var container = document.getElementById('resultsContainer');
                container.innerHTML = '';
                var raw = localStorage.getItem('surveyResults');
                if (!raw) {
                    container.innerHTML = '<p class="muted">Результаты не найдены. Пройдите опрос.</p>';
                    return;
                }
                var data;
                try {
                    data = JSON.parse(raw);
                } catch (e) {
                    container.innerHTML = '<p class="muted">Не удалось прочитать результаты.</p>';
                    return;
                }
                if (!Array.isArray(data) || data.length === 0) {
                    container.innerHTML = '<p class="muted">Результаты пусты.</p>';
                    return;
                }
                data.forEach(function(item) {
                    var div = document.createElement('div');
                    div.className = 'result-item';
                    var answerText = item && item.answer ? item.answer : '<span class="muted">нет ответа</span>';
                    div.innerHTML = '<div><strong>' +
                        (item && item.question ? item.question : ('Вопрос ' + (item && item.questionNumber ? item.questionNumber : ''))) +
                        '</strong></div>' +
                        '<div>Ответ: ' + answerText + '</div>';
                    container.appendChild(div);
                });
            }

            function goBack() { window.location.href = 'front.html'; }
            function clearResults() { localStorage.removeItem('surveyResults'); loadResults(); }

            document.addEventListener('DOMContentLoaded', function() {
                loadResults();
                document.getElementById('backBtn').addEventListener('click', goBack);
                document.getElementById('clearBtn').addEventListener('click', clearResults);
            });
        })();
    </script>
</body>
</html>
